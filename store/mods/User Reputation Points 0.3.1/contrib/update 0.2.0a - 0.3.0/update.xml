<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.1.xsd">
	<header>
		<license></license>
		<title lang="en">User reputation points - 0.2.0a - 0.3.0</title>
		<description lang="en">This will add the user reputation point system to your board</description>
		<author-notes lang="en"></author-notes>
		<author-group>
			<author>
				<realname>Pungky</realname>
				<email>pungkerz@gmail.com</email>
				<username>idiotnesia</username>
				<homepage>http://mod.web.id</homepage>
			</author>
		</author-group>
		<mod-version>	0.3.0&#13;</mod-version>
		<installation>
			<level>easy</level>
			<time>900</time>
			<target-version>3.0.4</target-version>
		</installation>
	</header>
	<action-group>
		<copy>
			<file from="root/reputation.php" to="reputation.php"/>
			<file from="root/viewreputation.php" to="viewreputation.php"/>
			<file from="root/adm/style/acp_rep_change_point.html" to="adm/style/acp_rep_change_point.html"/>
			<file from="root/adm/style/acp_rep_ranks.html" to="adm/style/acp_rep_ranks.html"/>
			<file from="root/images/reputation/*.*" to="images/reputation/*.*"/>
			<file from="root/includes/functions_reputation.php" to="includes/functions_reputation.php"/>
			<file from="root/includes/acp/acp_rep_change_point.php" to="includes/acp/acp_rep_change_point.php"/>
			<file from="root/includes/acp/acp_rep_ranks.php" to="includes/acp/acp_rep_ranks.php"/>
			<file from="root/includes/acp/acp_rep_settings.php" to="includes/acp/acp_rep_settings.php"/>
			<file from="root/includes/acp/info/acp_rep_change_point.php" to="includes/acp/info/acp_rep_change_point.php"/>
			<file from="root/includes/acp/info/acp_rep_ranks.php" to="includes/acp/info/acp_rep_ranks.php"/>
			<file from="root/includes/acp/info/acp_rep_settings.php" to="includes/acp/info/acp_rep_settings.php"/>
			<file from="root/language/en/mods/info_acp_reputation.php" to="language/en/mods/info_acp_reputation.php"/>
			<file from="root/language/en/mods/permissions_reputation.php" to="language/en/mods/permissions_reputation.php"/>
			<file from="root/language/en/mods/reputation_mod.php" to="language/en/mods/reputation_mod.php"/>
			<file from="root/styles/prosilver/template/reputation_body.html" to="styles/prosilver/template/reputation_body.html"/>
			<file from="root/styles/prosilver/template/viewreputation_body.html" to="styles/prosilver/template/viewreputation_body.html"/>
		</copy>
		<open src="&#13;&#10;common.php">
			<edit>
				<find>require($phpbb_root_path . 'includes/constants.' . $phpEx);&#13;
require($phpbb_root_path . 'includes/db/' . $dbms . '.' . $phpEx);&#13;
require($phpbb_root_path . 'includes/utf/utf_tools.' . $phpEx);</find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
require($phpbb_root_path . 'includes/functions_reputation.' . $phpEx);&#13;
// end</action>
			</edit>
		</open>
		<open src="&#13;&#10;memberlist.php">
			<edit>
				<find>// user reputation point&#13;
include($phpbb_root_path . 'includes/functions_reputation.' . $phpEx);&#13;
// end</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
		$user-&gt;add_lang('mods/reputation_mod');	&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find><![CDATA[//user reputation point			
			'REPUTATION'	=> $member['user_reputation'],
			'S_REPUTATION'	=> ($config['rp_enable'] && !$member['user_hide_reputation']),
			'REP_POWER'		=>  get_rep_power($member['user_posts'], $member['user_regdate'], $member['user_reputation'], $member['group_id']),
// end user reputation point]]></find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>		if (!empty($profile_fields['row']))&#13;
		{&#13;
			$template-&gt;assign_vars($profile_fields['row']);&#13;
		}</find>
				<action type="before-add">// idiotnesia wuz here - user rep point&#13;
		$user-&gt;add_lang('mods/reputation_mod');
		$template-&gt;assign_vars(array(&#13;
			'S_REPUTATION'		=&gt; $member['user_hide_reputation'] ? false : true,&#13;
			'REPUTATION'		=&gt; $member['user_reputation'],&#13;
			'REP_POWER'			=&gt; $reputation-&gt;get_rep_power($member['user_posts'], $member['user_regdate'], $member['user_reputation'], $member['group_id']),&#13;
			)&#13;
		);&#13;
// end</action>
			</edit>
		</open>
		<open src="&#13;&#10;viewtopic.php">
			<edit>
				<find>// Setup look and feel&#13;
$user-&gt;setup('viewtopic', $topic_data['forum_style']);</find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
$user-&gt;add_lang('mods/reputation_mod');&#13;
// end</action>
			</edit>
			<edit>
				<find><![CDATA[// user reputation point
$forum_exc = array();
if ($config['rp_enable'] && $config['rp_forum_exclusions'])
{
	$forum_exc = explode(',', $config['rp_forum_exclusions']);
}
// end]]></find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
	'S_REPUTATION'			=&gt; (!in_array($forum_id, $forum_exc)) ? true : false,&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// Does this topic contain a poll?</find>
				<action type="before-add">// idiotnesia wuz here - user rep point&#13;
$reputation-&gt;viewtopic($forum_id);&#13;
// end</action>
			</edit>
			<edit>
				<find>// user reputation points				&#13;
				'hidereputation'	=&gt; $row['user_hide_reputation'],&#13;
				'reputation_text'	=&gt; $row['user_reputation'],&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find><![CDATA[// user reputation points			
			if ($config['rp_enable'] && !$user_cache[$poster_id]['hidereputation'])
			{
				include_once($phpbb_root_path . 'includes/functions_reputation.' . $phpEx);
				$user_cache[$poster_id]['reputation'] = get_rep_img($row['user_reputation'], $row['username']);
			}
// end user reputation points]]></find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// Generate online information for user</find>
				<action type="before-add">// idiotnesia wuz here - user rep point&#13;
$reputation_cache = $reputation-&gt;get_user_reputation($id_cache);&#13;
// end</action>
			</edit>
			<edit>
				<find><![CDATA[// user reputation points
		'POSTER_REPUTATION'	=> ($config['rp_enable'] && !$user_cache[$poster_id]['hidereputation']) ? $user_cache[$poster_id]['reputation'] : '',
		'REP_TEXT'			=> ($config['rp_enable'] && !$user_cache[$poster_id]['hidereputation']) ? $user_cache[$poster_id]['reputation_text'] : '',
		'U_VIEW_REP' 		=> append_sid("{$phpbb_root_path}viewreputation.$phpEx", 'id=' . $poster_id),
		'U_REPUTATION' 		=> append_sid("{$phpbb_root_path}reputation.$phpEx", 'p=' . $row['post_id']),
		'U_REP_NEG' 		=> append_sid("{$phpbb_root_path}reputation.$phpEx", 'p=' . $row['post_id'] . '&amp;mode=negative'),
		'S_REP_TEXT'		=> ($config['rp_display'] == 1) ? true : false,
		'S_REP_BLOCK'		=> ($config['rp_display'] == 2) ? true : false,
		'S_REP_BOTH'		=> ($config['rp_display'] == 3) ? true : false,
// end user reputation points]]></find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find><![CDATA[	if (isset($cp_row['row']) && sizeof($cp_row['row']))
	{
		$postrow = array_merge($postrow, $cp_row['row']);
	}]]></find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
	$postrow = array_merge($postrow, $reputation-&gt;reputation_row($poster_id, $row['post_id'], $reputation_cache));&#13;
// end</action>
			</edit>
		</open>
		<open src="&#13;&#10;adm/style/acp_main.html">
			<edit>
				<find><![CDATA[			<form id="action_reputation_form" method="post" action="{U_ACTION}">
				<dl>
					<dt><label for="action_reputation">{L_RP_RESET}</label><br /><span>{L_RP_RESET_EXPLAIN}</span></dt>
					<dd><input type="hidden" name="action" value="reputation" /><input class="button2" type="submit" id="action_reputation" name="action_reputation" value="{L_RUN}" /></dd>
				</dl>
			</form>]]></find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;adm/style/acp_users_overview.html">
			<edit>
				<find><![CDATA[<dl>
	<dt><label>{L_RP_TOTAL_POINTS}:</label></dt>
	<dd><input type="text" id="user_reputation" name="user_reputation" maxlength="10" size="11" value="{USER_REPUTATION}" /></dd>
</dl>]]></find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/constants.php">
			<edit>
				<find>&#13;
// user reputation points&#13;
define('REPUTATIONS_TABLE',			$table_prefix . 'reputations');&#13;
define('REPUTATIONS_RANKS_TABLE',	$table_prefix . 'reputations_ranks');&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/functions_admin.php">
			<edit>
				<find>// user reputation points	&#13;
	$sql = 'DELETE FROM ' . REPUTATIONS_TABLE . '&#13;
				WHERE ' . $db-&gt;sql_in_set('rep_post_id', $post_ids);&#13;
			$db-&gt;sql_query($sql);	&#13;
// end</find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/functions_user.php">
			<edit>
				<find>	$update_ary = array(&#13;
		FORUMS_TABLE			=&gt; array('forum_last_poster_name'),&#13;
		MODERATOR_CACHE_TABLE	=&gt; array('username'),&#13;
		POSTS_TABLE				=&gt; array('post_username'),&#13;
		TOPICS_TABLE			=&gt; array('topic_first_poster_name', 'topic_last_poster_name'),&#13;
	);</find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
	$update_ary[REPUTATIONS_TABLE] = array('username');&#13;
// end</action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
		'user_reputation'		=&gt; ($config['rp_enable']) ? (int) $config['rp_reg_bonus'] : 0,&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>function user_delete($mode, $user_id, $post_username = false)&#13;
{&#13;
	global $cache, $config, $db, $user, $auth;&#13;
	global $phpbb_root_path, $phpEx;</find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
	global $reputation;&#13;
// end</action>
			</edit>
			<edit>
				<find><![CDATA[	if ($user_row['user_avatar'] && $user_row['user_avatar_type'] == AVATAR_UPLOAD)
	{
		avatar_delete('user', $user_row);
	}]]></find>
				<action type="after-add">&#13;
//idiotnesia wuz here&#13;
	$reputation-&gt;delete_user($user_id);&#13;
// end</action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
		'group_reputation_power'	=&gt; 'int',&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>	$group_only_ary = array('group_receive_pm', 'group_legend', 'group_message_limit', 'group_max_recipients', 'group_founder_manage', 'group_reputation_power');</find>
				<action type="replace-with">	$group_only_ary = array('group_receive_pm', 'group_legend', 'group_message_limit', 'group_max_recipients', 'group_founder_manage');&#13;
&#13;
// idiotnesia wuz here - user rep point&#13;
	$attribute_ary['group_reputation_power'] = 'int';&#13;
	$group_only_ary[] = 'group_reputation_power';&#13;
// end</action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/acp/acp_main.php">
			<edit>
				<find>// user reputation point&#13;
		$user-&gt;add_lang('mods/reputation_mod');&#13;
// end</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// user reputation point&#13;
					case 'reputation':&#13;
						$confirm = true;&#13;
						$confirm_lang = 'RP_RESET_CONFIRM';&#13;
					break;&#13;
// end</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// user reputation point&#13;
					case 'reputation':&#13;
					&#13;
					$db-&gt;sql_query('UPDATE ' . USERS_TABLE . &quot; SET user_reputation = 0&quot;);&#13;
					&#13;
						switch ($db-&gt;sql_layer)&#13;
						{&#13;
							case 'sqlite':&#13;
							case 'firebird':&#13;
								$db-&gt;sql_query('DELETE FROM ' . REPUTATIONS_TABLE);&#13;
							break;&#13;
&#13;
							default:&#13;
								$db-&gt;sql_query('TRUNCATE TABLE ' . REPUTATIONS_TABLE);&#13;
							break;&#13;
						}&#13;
						&#13;
						add_log('admin', 'LOG_RESET_REPUTATION');&#13;
					break;&#13;
// end</find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/acp/acp_groups.php">
			<edit>
				<find>// user reputation points		&#13;
		$user-&gt;add_lang(array('acp/groups', 'mods/reputation_mod'));&#13;
// end user reputation points</find>
				<action type="replace-with">		$user-&gt;add_lang('acp/groups');&#13;
&#13;
// idiotnesia wuz here - user rep point&#13;
		$user-&gt;add_lang('mods/reputation_mod');&#13;
// end</action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
						'reputation_power'	=&gt; request_var('group_reputation_power', 0),&#13;
// user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>					if ($user-&gt;data['user_type'] == USER_FOUNDER)&#13;
					{&#13;
						$submit_ary['founder_manage'] = isset($_REQUEST['group_founder_manage']) ? 1 : 0;&#13;
					}</find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
					$submit_ary['reputation_power'] = request_var('group_reputation_power', 0);&#13;
// end</action>
			</edit>
			<edit>
				<find>&#13;
						$test_variables = array('rank', 'colour', 'avatar', 'avatar_type', 'avatar_width', 'avatar_height', 'receive_pm', 'legend', 'message_limit', 'max_recipients', 'founder_manage', 'reputation_power');</find>
				<action type="replace-with">						$test_variables = array('rank', 'colour', 'avatar', 'avatar_type', 'avatar_width', 'avatar_height', 'receive_pm', 'legend', 'message_limit', 'max_recipients', 'founder_manage');&#13;
// idiotnesia wuz here - user rep point&#13;
						$test_variables[] = 'reputation_power';&#13;
// end</action>
			</edit>
			<edit>
				<find>// user reputation points					&#13;
					'GROUP_REPUTATION_POWER'	=&gt; (isset($group_row['group_reputation_power'])) ? $group_row['group_reputation_power'] : 0,&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>					'L_AVATAR_EXPLAIN'	=&gt; sprintf($user-&gt;lang['AVATAR_EXPLAIN'], $config['avatar_max_width'], $config['avatar_max_height'], round($config['avatar_filesize'] / 1024)),&#13;
					)&#13;
				);</find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
				$template-&gt;assign_vars(array(&#13;
					'GROUP_REPUTATION_POWER'	=&gt; (isset($group_row['group_reputation_power'])) ? $group_row['group_reputation_power'] : 0,&#13;
					)&#13;
				);&#13;
// end</action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/acp/acp_users.php">
			<edit>
				<find>		$user-&gt;add_lang(array('posting', 'ucp', 'acp/users', 'mods/reputation_mod'));</find>
				<action type="replace-with">		$user-&gt;add_lang(array('posting', 'ucp', 'acp/users'));</action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
						'user_reputation'	=&gt; request_var('user_reputation', $user_row['user_reputation'], true),&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
					$update_user_reputation = ($user_row['user_reputation'] != $data['user_reputation']) ? $data['user_reputation'] : false;&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>//user reputation points						&#13;
						if ($update_user_reputation !== false)&#13;
						{&#13;
							$sql_ary += array('user_reputation'	=&gt; $update_user_reputation);&#13;
&#13;
							add_log('user', $user_id, 'LOG_USER_UPDATE_REPUTATION', $user_row['username'], $user_row['user_reputation'], $update_user_reputation);&#13;
						}&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
					'USER_REPUTATION'	=&gt; $user_row['user_reputation'],&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/ucp/ucp_main.php">
			<edit>
				<find>// user reputation points&#13;
				$user-&gt;add_lang(array('memberlist', 'mods/reputation_mod'));&#13;
// end user reputation points</find>
				<action type="replace-with">				$user-&gt;add_lang('memberlist');</action>
			</edit>
			<edit>
				<find><![CDATA[//  user reputation points
				if ($config['rp_enable'])
				{
					$sql_array = array(
						'SELECT'	=> 'p.post_id, p.post_subject, p.forum_id, u.username, u.user_id, u.user_colour, r.*',

						'FROM'		=> array(
							POSTS_TABLE			=> 'p',
							REPUTATIONS_TABLE	=> 'r',
							USERS_TABLE			=> 'u'
				
						),

						'WHERE'		=> 'r.rep_to =' . $user->data['user_id'] . '
							AND u.user_id = r.rep_from
							AND r.rep_post_id = p.post_id',

						'ORDER_BY'	=> 'rep_id DESC'
					);

					$sql = $db->sql_build_query('SELECT', $sql_array);	
					$result = $db->sql_query_limit($sql, $config['rp_recent_points']);
					while ($row = $db->sql_fetchrow($result))
					{
						$row['bbcode_options'] = (($row['enable_bbcode']) ? OPTION_FLAG_BBCODE : 0) +
						(($row['enable_smilies']) ? OPTION_FLAG_SMILIES : 0) + 
						(($row['enable_urls']) ? OPTION_FLAG_LINKS : 0);
	
						$template->assign_block_vars('reputation', array(
							'FROM'			=> get_username_string('full', $row['user_id'], $row['username'], $row['user_colour'], $row['username']),
							'POINT'			=> $row['rep_point'],
							'POST_SUBJECT'	=> censor_text($row['post_subject']),
							'U_POST'		=> append_sid("{$phpbb_root_path}viewtopic.$phpEx", 'f=' . $row['forum_id'] . '&amp;p=' . $row['post_id']) . '#p' . $row['post_id'],
							'COMMENT'		=> generate_text_for_display($row['rep_comment'], $row['bbcode_uid'], $row['bbcode_bitfield'], $row['bbcode_options']))
	);
					}
					$db->sql_freeresult($result);
				}
// end user reputation points]]></find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
					'REPUTATION_POINTS'	=&gt; ($config['rp_enable']) ? $user-&gt;data['user_reputation'] : '',&#13;
					'S_REPUTATION'		=&gt; $auth-&gt;acl_get('u_rp_view'),&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;includes/ucp/ucp_prefs.php">
			<edit>
				<find>// user reputation points	&#13;
					'hidereputation'	=&gt; request_var('hidereputation', (bool) $user-&gt;data['user_hide_reputation']),&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find><![CDATA[				if ($data['notifymethod'] == NOTIFY_IM && (!$config['jab_enable'] || !$user->data['user_jabber'] || !@extension_loaded('xml')))
				{
					// Jabber isnt enabled, or no jabber field filled in. Update the users table to be sure its correct.
					$data['notifymethod'] = NOTIFY_BOTH;
				}]]></find>
				<action type="before-add">// idiotnesia wuz here - user rep point&#13;
				$data['hidereputation'] = request_var('hidereputation', (bool) $user-&gt;data['user_hide_reputation']);&#13;
// end</action>
			</edit>
			<edit>
				<find>// user reputation points&#13;
							'user_hide_reputation'	=&gt; $data['hidereputation'],&#13;
// end user reputation points</find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find>							'user_lang'				=&gt; $data['lang'],&#13;
							'user_timezone'			=&gt; $data['tz'],&#13;
							'user_style'			=&gt; $data['style'],&#13;
						);</find>
				<action type="after-add">&#13;
// idiotnesia wuz here - user rep point&#13;
						$sql_ary['user_hide_reputation'] = $data['hidereputation'];&#13;
// end</action>
			</edit>
			<edit>
				<find><![CDATA[// user reputation points
					'S_HIDE_REPUTATION'	=> $data['hidereputation'],
					'S_CAN_HIDE_REPUTATION'	=> ($config['rp_enable'] && $auth->acl_get('u_rp_disable')) ? true : false,
// end user reputation points]]></find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find><![CDATA[					'S_SELECT_NOTIFY'		=> ($config['jab_enable'] && $user->data['user_jabber'] && @extension_loaded('xml')) ? true : false)
				);]]></find>
				<action type="after-add"><![CDATA[
// idiotnesia wuz here - user rep point
				$template->assign_vars(array(
					'S_HIDE_REPUTATION'	=> $data['hidereputation'],
					'S_CAN_HIDE_REPUTATION'	=> ($config['rp_enable'] && $auth->acl_get('u_rp_disable')) ? true : false,
					)
				);
// end]]></action>
			</edit>
		</open>
		<open src="&#13;&#10;language/en/acp/common.php">
			<edit>
				<find><![CDATA[// user reputation points	
$lang = array_merge($lang, array(
	'ACP_REPUTATION_SETTINGS'		=> 'Reputation points settings',
	'ACP_MANAGE_REP_RANKS'			=> 'Reputation ranks management',
	'LOG_CONFIG_REPUTATION'			=> '<strong>Altered user reputation points settings</strong>',
	'LOG_RP_RANK_ADDED'				=> '<strong>Added new reputation rank</strong><br />» %s',
	'LOG_RP_RANK_REMOVED'			=> '<strong>Removed reputation rank</strong><br />» %s',
	'LOG_RP_RANK_UPDATED'			=> '<strong>Updated reputation rank</strong><br />» %s',
	'LOG_USER_UPDATE_REPUTATION'	=> '<strong>Changed reputation points</strong><br />» from “%2$s” to “%3$s”',
	'LOG_RESET_REPUTATION'			=> '<strong>Reputation point reset</strong>',
));
// end user reputation points]]></find>
				<action type="replace-with"></action>
			</edit>
		</open>
		<open src="&#13;&#10;styles/prosilver/template/viewtopic_body.html">
			<edit>
				<find><![CDATA[		<!-- IF postrow.POSTER_REPUTATION or postrow.REPUTATION_TEXT --><!-- IF postrow.S_REP_TEXT or postrow.S_REP_BOTH --><dd><strong>{L_RP_TOTAL_POINTS}:</strong> <!-- IF postrow.S_REP_TEXT --><a href="{postrow.U_VIEW_REP}">{postrow.REP_TEXT}</a><!-- ELSE -->{postrow.REP_TEXT}<!-- ENDIF --></dd><!-- ENDIF --><!-- IF postrow.S_REP_BLOCK or postrow.S_REP_BOTH --><dd><a href="{postrow.U_VIEW_REP}">{postrow.POSTER_REPUTATION}</a></dd><!-- ENDIF --><!-- IF S_REPUTATION --><dd><a href="{postrow.U_REPUTATION}"><img src="{T_IMAGES_PATH}reputation/add.png" title="{L_RP_ADD_POINTS}" alt="{L_RP_ADD_POINTS}" /></a><a href="{postrow.U_REP_NEG}"><img src="{T_IMAGES_PATH}reputation/subtract.png" title="{L_RP_SUBTRACT_POINTS}" alt="{L_RP_SUBTRACT_POINTS}" /></a><!-- ENDIF --></dd><!-- ENDIF -->]]></find>
				<action type="replace-with"><![CDATA[		<!-- IF S_REPUTATION and postrow.S_USER_REPUTATION -->
		<!-- IF S_REP_DISPLAY neq 'block' --><dd><strong>{L_RP_TOTAL_POINTS}:</strong> {postrow.REPUTATION_TEXT}<!-- ENDIF -->
		<!-- IF S_REP_DISPLAY neq 'text'  --><dd><!-- IF postrow.U_VIEW_REP --><a href="{postrow.U_VIEW_REP}" onclick="popup(this.href, 780, 550); return false;" ><!-- ENDIF -->{postrow.REPUTATION_BLOCK}<!-- IF postrow.U_VIEW_REP --></a><!-- ENDIF --><dd><!-- ENDIF -->
		<!-- IF postrow.S_GIVE_REPUTATION --><dd><a href="{postrow.U_ADD_POS}"><img src="{T_IMAGES_PATH}reputation/add.png" title="{L_RP_ADD_POINTS} {postrow.POST_AUTHOR}" alt="{L_RP_ADD_POINTS} {postrow.POST_AUTHOR}" /></a><!-- IF postrow.S_GIVE_NEGATIVE--><a href="{postrow.U_ADD_NEG}"><img src="{T_IMAGES_PATH}reputation/subtract.png" title="{L_RP_SUBTRACT_POINTS} {postrow.POST_AUTHOR}" alt="{L_RP_SUBTRACT_POINTS} {postrow.POST_AUTHOR}" /></a><!-- ENDIF --></dd><!-- ENDIF -->
		<!-- ENDIF -->]]></action>
			</edit>
		</open>
		<open src="&#13;&#10;styles/prosilver/template/ucp_main_front.html">
			<edit>
				<find><![CDATA[<!-- IF .reputation -->
	<h3>{L_RP_RECENT_POINTS}</h3>
	<table class="table1" cellspacing="0">
		<thead>
		<tr>
			<th class="name">{L_RP_POINTS}</th>
			<th class="name">{L_RP_COMMENTS}</th>
			<th class="name">{L_FROM}</th>
			<th class="name">{L_POSTS}</th>
		</tr>
		</thead>
		<tbody>
	<!-- BEGIN reputation -->
		<tr class="<!-- IF reputation.S_ROW_COUNT is even -->bg1<!-- ELSE -->bg2<!-- ENDIF -->">
			<td><span>{reputation.POINT}</span></td>
			<td><span>{reputation.COMMENT}</span></td>
			<td><span>{reputation.FROM}</span></td>
			<td><span><a href="{reputation.U_POST}">{reputation.POST_SUBJECT}</a></span></td>
		</tr>
	<!-- END reputation -->
		</tbody>
	</table>
<!-- ENDIF -->]]></find>
				<action type="replace-with"></action>
			</edit>
			<edit>
				<find><![CDATA[		<!-- IF REPUTATION_POINTS --><dt>{L_RP_TOTAL_POINTS}:</dt> <dd>{REPUTATION_POINTS}</dd><!-- ENDIF -->]]></find>
				<action type="replace-with"></action>
			</edit>
		</open>
	</action-group>
</mod>
