<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<?xml-stylesheet type="text/xsl" href="./modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http
://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.2.2.xsd">
	<header>
		<license>http://opensource.org/licenses/gpl-license.php GNU General Public License v2</license>
		
		<title lang="en">Custom Profile Fields Permissions</title>
		<title lang="tr">Özel Profil Alanı İzinleri</title>

		<description lang="en">Adds two user permissions to view and change any custom profile fields. Affects all of them or none of them.</description>
		<description lang="tr">İki yeni kullanıcı izini ile özel profil alanı görüntüleme ve değiştirme seçenekleri için sınırlama getirir. Tüm özel profil alanlarını birden etkiler.</description>

		<author-notes lang="en"></author-notes>
		
		<author-notes lang="tr"></author-notes>
		
		<author-group>
			<author>
				<realname></realname>
				<username>mtrs</username>
				<email>trst2007@gmail.com</email>
			</author>
		</author-group>
		
		<mod-version>1.0.1</mod-version>
		
		<installation>
			<level>easy</level>
			<time>180</time>
			<target-version>3.0.5</target-version>
		</installation>

		<history>
			<entry>
				<date>2009-02-17</date>
				<rev-version>0.0.1</rev-version>
				<changelog lang="en">
					<change>Initial release</change>
				</changelog>
				<changelog lang="tr">
					<change>Başlangıç sürümü</change>
				</changelog>
			</entry>
			<entry>
				<date>2009-07-02</date>
				<rev-version>1.0.0</rev-version>
				<changelog lang="en">
					<change>subsilver2 support</change>
					<change>Find edits changed</change>
					<change>UMIL support</change>
				</changelog>
				<changelog lang="tr">
					<change>subsilver2 desteği</change>
					<change>Ekle çıkar değişti</change>
					<change>UMIL desteği</change>
				</changelog>
			</entry>
			<entry>
				<date>2009-07-15</date>
				<rev-version>1.0.1</rev-version>
				<changelog lang="en">
					<change>MODDB denial</change>
					<change>Template edits removed, since no need after a required cpf fields bug fix</change>
				</changelog>
				<changelog lang="tr">
					<change>MODDB reddi</change>
					<change>Zorunlu özel profil alanı hatası sebebiyle tema düzenlemlemeleri kaldırıldı</change>
				</changelog>
			</entry>
		</history> 	
		<link-group>
			<link type="language" href="./tr.xml" lang="en">Turkish</link>
			<link type="language" href="./tr.xml" lang="tr">Türkçe</link>
		</link-group>		
	</header>	
	<action-group>
		<copy>
			<file from="root/language/en/mods/permissions_custom_profile.php" to="language/en/mods/permissions_custom_profile.php"></file>
			<file from="root/install_cpf_permission.php" to="install_cpf_permission.php"></file>
			<file from="root/umil/*.*" to="umil/*.*" />			
		</copy>
		<open src="viewtopic.php">
			<edit>
				<find><![CDATA[// Load custom profile fields
if ($config['load_cpf_viewtopic'])]]></find>
				<action type="before-add"><![CDATA[//Begin: Custom Profile Fields Permissions
$config['load_cpf_viewtopic'] = ($auth->acl_get('u_cpf_allow_see')) ? $config['load_cpf_viewtopic'] : 0;
//End: Custom Profile Fields Permissions]]></action>
			</edit>
			<edit>
				<find><![CDATA[       //
       if ($config['load_cpf_viewtopic'])]]></find>
				<action type="before-add"><![CDATA[	//Begin: Custom Profile Fields Permissions
	$config['load_cpf_viewtopic'] = ($auth->acl_get('u_cpf_allow_see')) ? $config['load_cpf_viewtopic'] : 0;
	//End: Custom Profile Fields Permissions]]></action>
			</edit>
		</open>
		<open src="memberlist.php">
			<edit>
				<find><![CDATA[          if ($config['load_cpf_viewprofile'])]]></find>
				<action type="before-add"><![CDATA[          //Begin: Custom Profile Fields Permissions
          $config['load_cpf_viewprofile'] = ($auth->acl_get('u_cpf_allow_see')) ? $config['load_cpf_viewprofile'] : 0;
          //End: Custom Profile Fields Permissions]]></action>
			</edit>			
			<edit>
				<find><![CDATA[			// Load custom profile fields
			if ($config['load_cpf_memberlist'])]]></find>
				<action type="before-add"><![CDATA[			//Begin: Custom Profile Fields Permissions
			$config['load_cpf_viewprofile'] = ($auth->acl_get('u_cpf_allow_see')) ? $config['load_cpf_viewprofile'] : 0;
			//End: Custom Profile Fields Permissions]]></action>
			</edit>
			<edit>
				<find><![CDATA[                $cp_row = array();
                if ($config['load_cpf_memberlist'])]]></find>
				<action type="before-add"><![CDATA[			//Begin: Custom Profile Fields Permissions
			$config['load_cpf_memberlist'] = ($auth->acl_get('u_cpf_allow_see')) ? $config['load_cpf_memberlist'] : 0;
			//End: Custom Profile Fields Permissions]]></action>
			</edit>			
		</open>
		<open src="includes/ucp/ucp_profile.php">
			<edit>
				<find><![CDATA[						// validate custom profile fields
						$cp->submit_cp_field('profile', $user->get_iso_lang_id(), $cp_data, $cp_error);]]></find>
				<action type="before-add"><![CDATA[					//Begin: Custom Profile Fields for Groups
					if ($auth->acl_get('u_cpf_allow_use'))
					{
					//End: Custom Profile Fields for Groups]]></action>
				<action type="after-add"><![CDATA[					//Begin: Custom Profile Fields for Groups
					}
					//End: Custom Profile Fields for Groups]]></action>
			</edit> 		
			<edit>
				<find><![CDATA[				// Get additional profile fields and assign them to the template block var 'profile_fields'
				$user->get_profile_fields($user->data['user_id']);

				$cp->generate_profile_fields('profile', $user->get_iso_lang_id());]]></find>
				<action type="before-add"><![CDATA[			//Begin: Custom Profile Fields for Groups
			if ($auth->acl_get('u_cpf_allow_use'))
			{
			//End: Custom Profile Fields for Groups]]></action>
				<action type="after-add"><![CDATA[			//Begin: Custom Profile Fields for Groups
			}
			//End: Custom Profile Fields for Groups]]></action>
			</edit>						
		</open>
		<diy-instructions lang="en">Point your browser to /install_cpf_permission.php then execute and delete install file
		Set permissions for the users/groups
		ACP-> USERS AND GROUPS -> User Permissions</diy-instructions>		
		<diy-instructions lang="tr">/install_cpf_permission.php dosyasını tarayıcıda çalıştırıp silin.
		Kullanıcı/grup izinlerini değiştirin
		Yönetim Paneli-> KULLANICI ve GRUPLAR -> Kullanıcı izinleri</diy-instructions>	
	</action-group>
</mod>